<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Drec api documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top d-block d-sm-none">
            <a href="../" class="navbar-brand">Drec api documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">








<ol class="breadcrumb">
  <li class="breadcrumb-item">Injectables</li>
  <li class="breadcrumb-item" >ReadsService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/pods/reads/reads.service.ts</code>
        </p>





            <section data-compodoc="block-index">
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#influxDB" >influxDB</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#logger" >logger</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#queryApi" >queryApi</a>
                            </li>
                            <li>
                                <a href="#timeOffset" >timeOffset</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#aggregateArray" >aggregateArray</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#checkhistoryreadexist" >checkhistoryreadexist</a>
                            </li>
                            <li>
                                <a href="#convertToISODate" >convertToISODate</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#execute" >execute</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#filterMeasurements" >filterMeasurements</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#findlastRead" >findlastRead</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#findLastReadForMeterWithinRange" >findLastReadForMeterWithinRange</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#firstvalidateEnergy" >firstvalidateEnergy</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getAccumulatedReads" >getAccumulatedReads</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getAggregateMeterReadsFirstEntryOfDevice" >getAggregateMeterReadsFirstEntryOfDevice</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getAllRead" >getAllRead</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#getCheckHistoryCertificateIssueDateLogForDevice" >getCheckHistoryCertificateIssueDateLogForDevice</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getDeltaMeterReadsFirstEntryOfDevice" >getDeltaMeterReadsFirstEntryOfDevice</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getDeviceHistoryCertificateIssueDate" >getDeviceHistoryCertificateIssueDate</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#getexisthistorydevcielogFilteredQuery" >getexisthistorydevcielogFilteredQuery</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#getGroupAggregatedReads" >getGroupAggregatedReads</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#gethistorydevcielogFilteredQuery" >gethistorydevcielogFilteredQuery</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#getLatestRead" >getLatestRead</a>
                            </li>
                            <li>
                                <a href="#getNumberOfDaysInMonth" >getNumberOfDaysInMonth</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getnumberOfHistReads" >getnumberOfHistReads</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getnumberOfOngReads" >getnumberOfOngReads</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getOffSetForInfluxQuery" >getOffSetForInfluxQuery</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getOngoingReads" >getOngoingReads</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getPaginatedData" >getPaginatedData</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#latestread" >latestread</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#NewfilterMeasurements" >NewfilterMeasurements</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#NewfindLatestRead" >NewfindLatestRead</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#NewhistoryvalidateEnergy" >NewhistoryvalidateEnergy</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#NewroundMeasurementsToUnit" >NewroundMeasurementsToUnit</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#newstoreGenerationReading" >newstoreGenerationReading</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#newstoreRead" >newstoreRead</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#NewvalidateEnergy" >NewvalidateEnergy</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#ongExecute" >ongExecute</a>
                            </li>
                            <li>
                                <a href="#readFilterNullUndefined" >readFilterNullUndefined</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#retrieveDataWithLastValue" >retrieveDataWithLastValue</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#roundMeasurementsToUnit" >roundMeasurementsToUnit</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#store" >store</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#storeGenerationReading" >storeGenerationReading</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#storeRead" >storeRead</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#updatehistorycertificateissuedate" >updatehistorycertificateissuedate</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#validateEnergy" >validateEnergy</a>
                            </li>
                        </ul>
                    </td>
                </tr>





                    <tr>
                        <td class="col-md-4">
                            <h6><b>Accessors</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                    <a href="#dbReader" >dbReader</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
        </tbody>
    </table>
</section>

            <section data-compodoc="block-constructor">
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(repository: <a href="../entitys/AggregateMeterRead.html" target="_self">Repository&lt;AggregateMeterRead&gt;</a>, historyrepository: <a href="../entitys/HistoryIntermediate_MeterRead.html" target="_self">Repository&lt;HistoryIntermediate_MeterRead&gt;</a>, deltarepository: <a href="../entitys/DeltaFirstRead.html" target="_self">Repository&lt;DeltaFirstRead&gt;</a>, baseReadsService: BaseReadService, deviceService: <a href="../injectables/DeviceService.html" target="_self">DeviceService</a>, deviceGroupService: <a href="../injectables/DeviceGroupService.html" target="_self">DeviceGroupService</a>, organizationService: <a href="../injectables/OrganizationService.html" target="_self">OrganizationService</a>, eventBus: EventBus)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="55" class="link-to-prism">src/pods/reads/reads.service.ts:55</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>repository</td>
                                                  
                                                        <td>
                                                                        <code><a href="../entitys/AggregateMeterRead.html" target="_self" >Repository&lt;AggregateMeterRead&gt;</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>historyrepository</td>
                                                  
                                                        <td>
                                                                        <code><a href="../entitys/HistoryIntermediate_MeterRead.html" target="_self" >Repository&lt;HistoryIntermediate_MeterRead&gt;</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>deltarepository</td>
                                                  
                                                        <td>
                                                                        <code><a href="../entitys/DeltaFirstRead.html" target="_self" >Repository&lt;DeltaFirstRead&gt;</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>baseReadsService</td>
                                                  
                                                        <td>
                                                                    <code>BaseReadService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>deviceService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/DeviceService.html" target="_self" >DeviceService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>deviceGroupService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/DeviceGroupService.html" target="_self" >DeviceGroupService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>organizationService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/OrganizationService.html" target="_self" >OrganizationService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>eventBus</td>
                                                  
                                                        <td>
                                                                    <code>EventBus</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section data-compodoc="block-methods">
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="aggregateArray"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>aggregateArray</b></span>
                        <a href="#aggregateArray"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>aggregateArray(aggregate: Aggregate, array: number[])</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1090"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1090</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>aggregate</td>
                                            <td>
                                                        <code>Aggregate</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>array</td>
                                            <td>
                                                        <code>number[]</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="checkhistoryreadexist"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>checkhistoryreadexist</b></span>
                        <a href="#checkhistoryreadexist"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>checkhistoryreadexist(deviceid: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, startDate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>, endDate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="768"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:768</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>deviceid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>startDate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>endDate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;boolean&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="convertToISODate"></a>
                    <span class="name">
                        <span ><b>convertToISODate</b></span>
                        <a href="#convertToISODate"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>convertToISODate(month, year)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1552"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1552</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>month</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>year</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="execute"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>execute</b></span>
                        <a href="#execute"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>execute(query: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="748"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:748</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>query</td>
                                            <td>
                                                            <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="filterMeasurements"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>filterMeasurements</b></span>
                        <a href="#filterMeasurements"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>filterMeasurements(id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, measurement: MeasurementDTO, device: <a href="../classes/DeviceDTO.html" target="_self">DeviceDTO</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="209"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:209</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>id</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>measurement</td>
                                            <td>
                                                        <code>MeasurementDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>device</td>
                                            <td>
                                                            <code><a href="../classes/DeviceDTO.html" target="_self" >DeviceDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;MeasurementDTO&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findlastRead"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>findlastRead</b></span>
                        <a href="#findlastRead"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>findlastRead(deviceId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="288"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:288</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>deviceId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../entitys/AggregateMeterRead.html" target="_self" >Promise&lt;AggregateMeterRead[]&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findLastReadForMeterWithinRange"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>findLastReadForMeterWithinRange</b></span>
                        <a href="#findLastReadForMeterWithinRange"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>findLastReadForMeterWithinRange(meterId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, startdate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>, enddate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="739"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:739</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>meterId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>startdate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>enddate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;Array&lt;literal type&gt;&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="firstvalidateEnergy"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>firstvalidateEnergy</b></span>
                        <a href="#firstvalidateEnergy"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>firstvalidateEnergy(read: ReadDTO, device: <a href="../classes/DeviceDTO.html" target="_self">DeviceDTO</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="814"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:814</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>read</td>
                                            <td>
                                                        <code>ReadDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>device</td>
                                            <td>
                                                            <code><a href="../classes/DeviceDTO.html" target="_self" >DeviceDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>literal type</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getAccumulatedReads"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getAccumulatedReads</b></span>
                        <a href="#getAccumulatedReads"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getAccumulatedReads(meter: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, organizationId, developerExternalId, accumulationType, month: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, year: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1435"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1435</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>meter</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>organizationId</td>
                                            <td>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>developerExternalId</td>
                                            <td>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>accumulationType</td>
                                            <td>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>month</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>year</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getAggregateMeterReadsFirstEntryOfDevice"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getAggregateMeterReadsFirstEntryOfDevice</b></span>
                        <a href="#getAggregateMeterReadsFirstEntryOfDevice"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getAggregateMeterReadsFirstEntryOfDevice(meterId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1179"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1179</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>meterId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../entitys/AggregateMeterRead.html" target="_self" >Promise&lt;AggregateMeterRead[]&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getAllRead"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getAllRead</b></span>
                        <a href="#getAllRead"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getAllRead(externalId, filter, deviceOnboarded, pageNumber: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1203"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1203</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>externalId</td>
                                            <td>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>filter</td>
                                            <td>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>deviceOnboarded</td>
                                            <td>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>pageNumber</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;any&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getCheckHistoryCertificateIssueDateLogForDevice"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>getCheckHistoryCertificateIssueDateLogForDevice</b></span>
                        <a href="#getCheckHistoryCertificateIssueDateLogForDevice"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getCheckHistoryCertificateIssueDateLogForDevice(deviceid: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, startDate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>, endDate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1098"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1098</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>deviceid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>startDate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>endDate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../entitys/HistoryIntermediate_MeterRead.html" target="_self" >Promise&lt;HistoryIntermediate_MeterRead[]&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getDeltaMeterReadsFirstEntryOfDevice"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getDeltaMeterReadsFirstEntryOfDevice</b></span>
                        <a href="#getDeltaMeterReadsFirstEntryOfDevice"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getDeltaMeterReadsFirstEntryOfDevice(meterId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1191"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1191</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>meterId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../entitys/DeltaFirstRead.html" target="_self" >Promise&lt;DeltaFirstRead[]&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getDeviceHistoryCertificateIssueDate"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getDeviceHistoryCertificateIssueDate</b></span>
                        <a href="#getDeviceHistoryCertificateIssueDate"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getDeviceHistoryCertificateIssueDate(conditions: <a href="../entitys/HistoryIntermediate_MeterRead.html" target="_self">FindConditions&lt;HistoryIntermediate_MeterRead&gt;</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1157"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1157</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>conditions</td>
                                            <td>
                                                            <code><a href="../entitys/HistoryIntermediate_MeterRead.html" target="_self" >FindConditions&lt;HistoryIntermediate_MeterRead&gt;</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../entitys/HistoryIntermediate_MeterRead.html" target="_self" >Promise&lt;HistoryIntermediate_MeterRead | null&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getexisthistorydevcielogFilteredQuery"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>getexisthistorydevcielogFilteredQuery</b></span>
                        <a href="#getexisthistorydevcielogFilteredQuery"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getexisthistorydevcielogFilteredQuery(deviceid: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, startDate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>, endDate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="790"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:790</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>deviceid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>startDate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>endDate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../entitys/HistoryIntermediate_MeterRead.html" target="_self" >SelectQueryBuilder&lt;HistoryIntermediate_MeterRead&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getGroupAggregatedReads"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>getGroupAggregatedReads</b></span>
                        <a href="#getGroupAggregatedReads"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getGroupAggregatedReads(groupId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, filter: AggregateFilterDTO)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="79"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:79</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>groupId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>filter</td>
                                            <td>
                                                        <code>AggregateFilterDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;AggregatedReadDTO[]&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="gethistorydevcielogFilteredQuery"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>gethistorydevcielogFilteredQuery</b></span>
                        <a href="#gethistorydevcielogFilteredQuery"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>gethistorydevcielogFilteredQuery(deviceid: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, startDate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>, endDate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1128"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1128</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>deviceid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>startDate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>endDate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../entitys/HistoryIntermediate_MeterRead.html" target="_self" >SelectQueryBuilder&lt;HistoryIntermediate_MeterRead&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getLatestRead"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>getLatestRead</b></span>
                        <a href="#getLatestRead"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getLatestRead(meterId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="227"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:227</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>meterId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;ReadDTO | void&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getNumberOfDaysInMonth"></a>
                    <span class="name">
                        <span ><b>getNumberOfDaysInMonth</b></span>
                        <a href="#getNumberOfDaysInMonth"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getNumberOfDaysInMonth(month, year)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1566"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1566</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>month</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>year</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getnumberOfHistReads"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getnumberOfHistReads</b></span>
                        <a href="#getnumberOfHistReads"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getnumberOfHistReads(deviceId, startDate, endDate)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1376"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1376</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>deviceId</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>startDate</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>endDate</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getnumberOfOngReads"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getnumberOfOngReads</b></span>
                        <a href="#getnumberOfOngReads"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getnumberOfOngReads(start: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>, end: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>, externalId, onboarded: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1387"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1387</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>start</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>end</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>externalId</td>
                                            <td>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>onboarded</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getOffSetForInfluxQuery"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getOffSetForInfluxQuery</b></span>
                        <a href="#getOffSetForInfluxQuery"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getOffSetForInfluxQuery(developerExternalId, organizationId, startDate)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1661"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1661</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>developerExternalId</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>organizationId</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>startDate</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getOngoingReads"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getOngoingReads</b></span>
                        <a href="#getOngoingReads"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getOngoingReads(meter, filter)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1695"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1695</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>meter</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>filter</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;any&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getPaginatedData"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getPaginatedData</b></span>
                        <a href="#getPaginatedData"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getPaginatedData(meter: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, filter: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, page: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1618"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1618</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>meter</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>filter</td>
                                            <td>
                                                            <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>page</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;[]&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="latestread"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>latestread</b></span>
                        <a href="#latestread"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>latestread(meterId, deviceOnboarded)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1423"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1423</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>meterId</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>deviceOnboarded</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="NewfilterMeasurements"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>NewfilterMeasurements</b></span>
                        <a href="#NewfilterMeasurements"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>NewfilterMeasurements(deviceId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, measurement: <a href="../classes/NewIntmediateMeterReadDTO.html" target="_self">NewIntmediateMeterReadDTO</a>, device: <a href="../classes/DeviceDTO.html" target="_self">DeviceDTO</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="360"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:360</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>deviceId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>measurement</td>
                                            <td>
                                                            <code><a href="../classes/NewIntmediateMeterReadDTO.html" target="_self" >NewIntmediateMeterReadDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>device</td>
                                            <td>
                                                            <code><a href="../classes/DeviceDTO.html" target="_self" >DeviceDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;MeasurementDTO&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="NewfindLatestRead"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>NewfindLatestRead</b></span>
                        <a href="#NewfindLatestRead"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>NewfindLatestRead(meterId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, deviceregisterdate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="728"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:728</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>meterId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>deviceregisterdate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;ReadDTO | void&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="NewhistoryvalidateEnergy"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>NewhistoryvalidateEnergy</b></span>
                        <a href="#NewhistoryvalidateEnergy"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>NewhistoryvalidateEnergy(read: ReadDTO, device: <a href="../classes/DeviceDTO.html" target="_self">DeviceDTO</a>, requestmeteredTimePeriod: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, measurement: <a href="../classes/NewIntmediateMeterReadDTO.html" target="_self">NewIntmediateMeterReadDTO</a>, startdate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>, enddate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="953"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:953</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>read</td>
                                            <td>
                                                        <code>ReadDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>device</td>
                                            <td>
                                                            <code><a href="../classes/DeviceDTO.html" target="_self" >DeviceDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>requestmeteredTimePeriod</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>measurement</td>
                                            <td>
                                                            <code><a href="../classes/NewIntmediateMeterReadDTO.html" target="_self" >NewIntmediateMeterReadDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>startdate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>enddate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;boolean&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="NewroundMeasurementsToUnit"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>NewroundMeasurementsToUnit</b></span>
                        <a href="#NewroundMeasurementsToUnit"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>NewroundMeasurementsToUnit(measurement: <a href="../classes/NewIntmediateMeterReadDTO.html" target="_self">NewIntmediateMeterReadDTO</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="331"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:331</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>measurement</td>
                                            <td>
                                                            <code><a href="../classes/NewIntmediateMeterReadDTO.html" target="_self" >NewIntmediateMeterReadDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/NewIntmediateMeterReadDTO.html" target="_self" >NewIntmediateMeterReadDTO</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="newstoreGenerationReading"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>newstoreGenerationReading</b></span>
                        <a href="#newstoreGenerationReading"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>newstoreGenerationReading(id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, measurements: MeasurementDTO, device: <a href="../classes/DeviceDTO.html" target="_self">DeviceDTO</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1054"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1054</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>id</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>measurements</td>
                                            <td>
                                                        <code>MeasurementDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>device</td>
                                            <td>
                                                            <code><a href="../classes/DeviceDTO.html" target="_self" >DeviceDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="newstoreRead"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>newstoreRead</b></span>
                        <a href="#newstoreRead"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>newstoreRead(id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, measurements: <a href="../classes/NewIntmediateMeterReadDTO.html" target="_self">NewIntmediateMeterReadDTO</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="300"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:300</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>id</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>measurements</td>
                                            <td>
                                                            <code><a href="../classes/NewIntmediateMeterReadDTO.html" target="_self" >NewIntmediateMeterReadDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="NewvalidateEnergy"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>NewvalidateEnergy</b></span>
                        <a href="#NewvalidateEnergy"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>NewvalidateEnergy(read: ReadDTO, final: ReadDTO, device: <a href="../classes/DeviceDTO.html" target="_self">DeviceDTO</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="884"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:884</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>read</td>
                                            <td>
                                                        <code>ReadDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>final</td>
                                            <td>
                                                        <code>ReadDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>device</td>
                                            <td>
                                                            <code><a href="../classes/DeviceDTO.html" target="_self" >DeviceDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>literal type</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="ongExecute"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>ongExecute</b></span>
                        <a href="#ongExecute"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>ongExecute(query: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1413"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1413</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>query</td>
                                            <td>
                                                            <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="readFilterNullUndefined"></a>
                    <span class="name">
                        <span ><b>readFilterNullUndefined</b></span>
                        <a href="#readFilterNullUndefined"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>readFilterNullUndefined(arr)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1536"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1536</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>arr</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="retrieveDataWithLastValue"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>retrieveDataWithLastValue</b></span>
                        <a href="#retrieveDataWithLastValue"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>retrieveDataWithLastValue(meter: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, filter: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, skipCount: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, pageSize: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1627"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1627</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>meter</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>filter</td>
                                            <td>
                                                            <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>skipCount</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>pageSize</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;[]&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="roundMeasurementsToUnit"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>roundMeasurementsToUnit</b></span>
                        <a href="#roundMeasurementsToUnit"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>roundMeasurementsToUnit(measurement: MeasurementDTO)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="184"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:184</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>measurement</td>
                                            <td>
                                                        <code>MeasurementDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>MeasurementDTO</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="store"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>store</b></span>
                        <a href="#store"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>store(id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, measurements: MeasurementDTO)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="179"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:179</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>id</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>measurements</td>
                                            <td>
                                                        <code>MeasurementDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="storeGenerationReading"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>storeGenerationReading</b></span>
                        <a href="#storeGenerationReading"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>storeGenerationReading(id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, measurements: MeasurementDTO, device: <a href="../classes/DeviceDTO.html" target="_self">DeviceDTO</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="144"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:144</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>id</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>measurements</td>
                                            <td>
                                                        <code>MeasurementDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>device</td>
                                            <td>
                                                            <code><a href="../classes/DeviceDTO.html" target="_self" >DeviceDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="storeRead"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>storeRead</b></span>
                        <a href="#storeRead"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>storeRead(id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, measurements: MeasurementDTO)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="119"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:119</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>id</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>measurements</td>
                                            <td>
                                                        <code>MeasurementDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="updatehistorycertificateissuedate"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>updatehistorycertificateissuedate</b></span>
                        <a href="#updatehistorycertificateissuedate"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>updatehistorycertificateissuedate(id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, startdate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>, enddate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="1162"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:1162</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>id</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>startdate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>enddate</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../entitys/HistoryIntermediate_MeterRead.html" target="_self" >Promise&lt;HistoryIntermediate_MeterRead&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="validateEnergy"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>validateEnergy</b></span>
                        <a href="#validateEnergy"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>validateEnergy(read: ReadDTO, final: ReadDTO, device: <a href="../classes/DeviceDTO.html" target="_self">DeviceDTO</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="236"
                                    class="link-to-prism">src/pods/reads/reads.service.ts:236</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>read</td>
                                            <td>
                                                        <code>ReadDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>final</td>
                                            <td>
                                                        <code>ReadDTO</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>device</td>
                                            <td>
                                                            <code><a href="../classes/DeviceDTO.html" target="_self" >DeviceDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section data-compodoc="block-properties">
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="influxDB"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>influxDB</b></span>
                        <a href="#influxDB"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>InfluxDB</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="54" class="link-to-prism">src/pods/reads/reads.service.ts:54</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="logger"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>logger</b></span>
                        <a href="#logger"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new Logger(ReadsService.name)</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="51" class="link-to-prism">src/pods/reads/reads.service.ts:51</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="queryApi"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>queryApi</b></span>
                        <a href="#queryApi"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>QueryApi</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="55" class="link-to-prism">src/pods/reads/reads.service.ts:55</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="timeOffset"></a>
                    <span class="name">
                        <span ><b>timeOffset</b></span>
                        <a href="#timeOffset"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1202" class="link-to-prism">src/pods/reads/reads.service.ts:1202</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
</section>

            <section data-compodoc="block-accessors">
    <h3 id="accessors">
        Accessors
    </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="dbReader"></a>
                        <span class="name"><b>dbReader</b><a href="#dbReader"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>dbReader()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="755" class="link-to-prism">src/pods/reads/reads.service.ts:755</a></div>
                                </td>
                            </tr>

            </tbody>
        </table>
</section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Inject, Injectable, Logger, NotFoundException, ConflictException, HttpException, HttpStatus } from &#x27;@nestjs/common&#x27;;
import { FindOneOptions, Repository, Brackets, SelectQueryBuilder, In, FindConditions, Any } from &#x27;typeorm&#x27;;

import axios from &#x27;axios&#x27;;
import {
  Aggregate,
  AggregatedReadDTO,
  AggregateFilterDTO,
  MeasurementDTO,
  ReadDTO,
  FilterDTO,
  ReadsService as BaseReadService,
  Unit,
} from &#x27;@energyweb/energy-api-influxdb&#x27;;
import { ExtendedBaseEntity } from &#x27;@energyweb/origin-backend-utils&#x27;;
import { DeviceService } from &#x27;../device/device.service&#x27;;
import { OrganizationService } from &#x27;../organization/organization.service&#x27;;
import { DateTime } from &#x27;luxon&#x27;;
import { BASE_READ_SERVICE } from &#x27;./const&#x27;;
import { EventBus } from &#x27;@nestjs/cqrs&#x27;;
import { GenerationReadingStoredEvent } from &#x27;../../events/GenerationReadingStored.event&#x27;;
import { BigNumber } from &#x27;ethers&#x27;;
import { DeviceDTO } from &#x27;../device/dto&#x27;;
import { DeviceGroupService } from &#x27;../device-group/device-group.service&#x27;;
import { HistoryIntermediate_MeterRead } from &#x27;./history_intermideate_meterread.entity&#x27;;
import { AggregateMeterRead } from &#x27;./aggregate_readvalue.entity&#x27;;
import { flattenDeep, values, groupBy, mean, sum, head } from &#x27;lodash&#x27;;
import { NewIntmediateMeterReadDTO, IntmediateMeterReadDTO } from &#x27;./dto/intermediate_meter_read.dto&#x27;;
import { Iintermediate, NewReadDTO, IAggregateintermediate } from &#x27;../../models&#x27;
import { InjectRepository } from &#x27;@nestjs/typeorm&#x27;;
import { GetMarketplaceOrganizationHandler } from &#x27;@energyweb/origin-backend/dist/js/src/pods/organization/handlers/get-marketplace-organization.handler&#x27;;
import { ReadStatus } from &#x27;../../utils/enums&#x27;;
import { DeltaFirstRead } from &#x27;./delta_firstread.entity&#x27;
import { HistoryNextInssuanceStatus } from &#x27;../../utils/enums/history_next_issuance.enum&#x27;
import { ReadFilterDTO } from &#x27;./dto/filter.dto&#x27;
import * as mapBoxTimeSpace from &#x27;@mapbox/timespace&#x27;;
import * as momentTimeZone from &#x27;moment-timezone&#x27;;
import { InfluxDB, QueryApi, } from &#x27;@influxdata/influxdb-client&#x27;;

import { Cron, CronExpression } from &#x27;@nestjs/schedule&#x27;;
import { response } from &#x27;express&#x27;;
import { EndReservationdateDTO } from &#x27;../device-group/dto&#x27;;
import { timestamp } from &#x27;rxjs/operators&#x27;;
import { getFormattedOffSetFromOffsetAsJson, getLocalTime, getLocalTimeZoneFromDevice, getOffsetFromTimeZoneName } from &#x27;../../utils/localTimeDetailsForDevice&#x27;;
import { log } from &#x27;console&#x27;;

export type TUserBaseEntity &#x3D; ExtendedBaseEntity &amp; IAggregateintermediate;

@Injectable()
export class ReadsService {
  private readonly logger &#x3D; new Logger(ReadsService.name);
  // private influx: InfluxDB;
  //  private queryApi: QueryApi;
  private readonly influxDB: InfluxDB;
  private readonly queryApi: QueryApi;
  constructor(
    @InjectRepository(AggregateMeterRead) private readonly repository: Repository&lt;AggregateMeterRead&gt;,
    @InjectRepository(HistoryIntermediate_MeterRead) private readonly historyrepository: Repository&lt;HistoryIntermediate_MeterRead&gt;,
    @InjectRepository(DeltaFirstRead) private readonly deltarepository: Repository&lt;DeltaFirstRead&gt;,
    @Inject(BASE_READ_SERVICE)
    private baseReadsService: BaseReadService,
    private readonly deviceService: DeviceService,
    private readonly deviceGroupService: DeviceGroupService,
    private readonly organizationService: OrganizationService,
    private readonly eventBus: EventBus,

  ) {
    //@ts-ignore
    const url &#x3D; process.env.INFLUXDB_URL;
    //@ts-ignore
    const token &#x3D; process.env.INFLUXDB_TOKEN;
    //@ts-ignore
    const org &#x3D; process.env.INFLUXDB_ORG;

    this.influxDB &#x3D; new InfluxDB({ url, token });
    this.queryApi &#x3D; this.influxDB.getQueryApi(org);
  }

  public async getGroupAggregatedReads(
    groupId: number,
    filter: AggregateFilterDTO,
  ): Promise&lt;AggregatedReadDTO[]&gt; {
    const deviceGroup &#x3D; await this.deviceGroupService.findById(groupId);
    if (!deviceGroup.devices?.length) {
      throw new NotFoundException(
        &#x60;No devices were found for group with id ${groupId}&#x60;,
      );
    }
    const allReads &#x3D; flattenDeep(
      await Promise.all(
        deviceGroup.devices.map(
          async (device: DeviceDTO) &#x3D;&gt;
            await this.baseReadsService.aggregate(device.externalId, filter),
        ),
      ),
    );

    // Group all read which have same start and stop dates
    const readsGroupedBySameDates &#x3D; values(
      groupBy(allReads, (read) &#x3D;&gt; JSON.stringify([read.start, read.stop])),
    );

    const aggregatedReads &#x3D; readsGroupedBySameDates.map(
      (group: AggregatedReadDTO[]): AggregatedReadDTO &#x3D;&gt; {
        return {
          start: group[0].start,
          stop: group[0].stop,
          value: this.aggregateArray(
            filter.aggregate,
            group.map((item: AggregatedReadDTO) &#x3D;&gt; item.value),
          ),
        };
      },
    );

    return aggregatedReads;
  }

  public async storeRead(
    id: string,
    measurements: MeasurementDTO,
  ): Promise&lt;void&gt; {
    this.logger.debug(&#x27;DREC is storing smart meter reads:&#x27;);
    this.logger.debug(JSON.stringify(measurements));
    //console.log(measurements);
    const device &#x3D; await this.deviceService.findReads(id);

    if (!device) {
      throw new NotFoundException(&#x60;No device found with external id ${id}&#x60;);
    }

    const roundedMeasurements &#x3D; this.roundMeasurementsToUnit(measurements);
    //console.log(roundedMeasurements);
    const filteredMeasurements &#x3D; await this.filterMeasurements(
      id,
      roundedMeasurements,
      device,
    );
    //console.log(filteredMeasurements);
    await this.storeGenerationReading(id, filteredMeasurements, device);
  }


  private async storeGenerationReading(
    id: string,
    measurements: MeasurementDTO,
    device: DeviceDTO,
  ): Promise&lt;void&gt; {
    const organization &#x3D; await this.organizationService.findOne(
      device.organizationId,
    );
    //console.log(&#x27;109&#x27;)
    if (!organization) {
      throw new NotFoundException(
        &#x60;No organization found with device organization code ${device.organizationId}&#x60;,
      );
    }

    await this.store(id, measurements);

    for (const measurement of measurements.reads) {
      const startTime &#x3D; DateTime.fromJSDate(measurement.timestamp)
        .minus({ minutes: 30 })
        .toJSDate();
      const endTime &#x3D; DateTime.fromJSDate(measurement.timestamp).toJSDate();

      this.eventBus.publish(
        new GenerationReadingStoredEvent({
          deviceId: id,
          energyValue: BigNumber.from(measurement.value),
          fromTime: startTime,
          toTime: endTime,
          organizationId: organization.id.toString(),
        }),
      );
    }
  }

  private async store(id: string, measurements: MeasurementDTO): Promise&lt;void&gt; {
    //console.log(&quot;137&quot;)
    return await this.baseReadsService.store(id, measurements);
  }

  private roundMeasurementsToUnit(measurement: MeasurementDTO): MeasurementDTO {
    const getMultiplier &#x3D; (unit: Unit) &#x3D;&gt; {
      switch (unit) {
        case Unit.Wh:
          return 1;
        case Unit.kWh:
          return 10 ** 3;
        case Unit.MWh:
          return 10 ** 6;
        case Unit.GWh:
          return 10 ** 9;
      }
    };

    const multiplier &#x3D; getMultiplier(measurement.unit);

    return {
      reads: measurement.reads.map((r) &#x3D;&gt; ({
        timestamp: r.timestamp,
        value: Math.round(r.value * multiplier),
      })),
      unit: Unit.Wh,
    };
  }

  private async filterMeasurements(
    id: string,
    measurement: MeasurementDTO,
    device: DeviceDTO,
  ): Promise&lt;MeasurementDTO&gt; {
    const final &#x3D; await this.getLatestRead(id);
    if (!final || !device) {
      return measurement;
    } else {
      return {
        reads: measurement.reads.filter((read: ReadDTO) &#x3D;&gt;
          this.validateEnergy(read, final, device),
        ),
        unit: measurement.unit,
      };
    }
  }

  private async getLatestRead(meterId: string): Promise&lt;ReadDTO | void&gt; {
    try {
      return await this.baseReadsService.findLatestRead(meterId);
    } catch (e) {
      this.logger.warn(e.message);
      return;
    }
  }

  private validateEnergy(
    read: ReadDTO,
    final: ReadDTO,
    device: DeviceDTO,
  ): boolean {
    const computeMaxEnergy &#x3D; (
      capacity: number,
      meteredTimePeriod: number,
      deviceAge: number,
      degradation: number,
      yieldValue: number,
    ) &#x3D;&gt; {
      // Max calculated energy formula &#x3D; Device capacity [kW] * metered time period [h] * device age [years] * degradation [%/year] * yield [kWh/kW]
      return (
        capacity * meteredTimePeriod * deviceAge * degradation * yieldValue
      );
    };
    const degradation &#x3D; 0.5; // [%/year]
    const yieldValue &#x3D; device.yieldValue || 1500; // [kWh/kW]
    const capacity &#x3D; device.capacity; // W
    const commissioningDate &#x3D; DateTime.fromISO(device.commissioningDate);
    const currentDate &#x3D; DateTime.now();
    let deviceAge &#x3D;
      currentDate.diff(commissioningDate, [&#x27;years&#x27;]).toObject().years || 0; // years
    if (deviceAge &#x3D;&#x3D; 0) {
      deviceAge &#x3D; 1;
    }
    const currentRead &#x3D; DateTime.fromISO(read.timestamp.toISOString());
    const lastRead &#x3D; DateTime.fromISO(final.timestamp.toISOString());
    this.logger.debug(&#x60;Current Date: ${DateTime.now()}&#x60;);
    this.logger.debug(&#x60;Current read: ${read.timestamp}&#x60;);
    this.logger.debug(&#x60;Last read: ${final.timestamp}&#x60;);
    const meteredTimePeriod &#x3D; Math.abs(
      currentRead.diff(lastRead, [&#x27;hours&#x27;]).toObject()?.hours || 0,
    ); // hours
    const margin &#x3D; 0.2; // Margin for comparing read value with computed max energy
    const maxEnergy &#x3D; computeMaxEnergy(
      capacity,
      meteredTimePeriod,
      deviceAge,
      degradation,
      yieldValue,
    );
    this.logger.debug(
      &#x60;capacity: ${capacity}, meteredTimePeriod: ${meteredTimePeriod}, deviceAge: ${deviceAge}, degradation: ${degradation}, yieldValue: ${yieldValue}&#x60;,
    );
    this.logger.debug(&#x60;${read.value + margin * read.value &lt; maxEnergy ? &#x27;Passed&#x27; : &#x27;Failed&#x27;}, MaxEnergy: ${maxEnergy}&#x60;,
    );
    return Math.round(read.value + margin * read.value) &lt; maxEnergy;
  }


  public findlastRead(deviceId: string): Promise&lt;AggregateMeterRead[]&gt; {
    return this.repository.find({
      where: { externalId: deviceId },
      order: {
        id: &#x27;DESC&#x27;,
      },
      take: 1
    });

  }

  // new meter read process
  public async newstoreRead(
    id: string,
    measurements: NewIntmediateMeterReadDTO,

  ): Promise&lt;void&gt; {
    this.logger.debug(&#x27;DREC is storing smart meter reads:&#x27;);
    this.logger.debug(JSON.stringify(measurements));
    //console.log(measurements);
    //change function for find device info by developer externalid
    const device &#x3D; await this.deviceService.findReads(id);
    if (!device) {
      throw new NotFoundException(&#x60;No device found with external id ${id}&#x60;);
    }


    if (device.timezone &#x3D;&#x3D;&#x3D; null &amp;&amp; measurements.timezone !&#x3D;&#x3D; null &amp;&amp; measurements.timezone !&#x3D;&#x3D; undefined &amp;&amp; measurements.timezone.toString().trim() !&#x3D;&#x3D; &#x27;&#x27;) {
      await this.deviceService.updatetimezone(device.externalId, measurements.timezone);
    }

    const roundedMeasurements &#x3D; this.NewroundMeasurementsToUnit(measurements);

    const filteredMeasurements &#x3D; await this.NewfilterMeasurements(
      id,
      roundedMeasurements,
      device,
    );
    console.log(filteredMeasurements);
    await this.newstoreGenerationReading(id, filteredMeasurements, device);
  }


  private NewroundMeasurementsToUnit(measurement: NewIntmediateMeterReadDTO): NewIntmediateMeterReadDTO {
    const getMultiplier &#x3D; (unit: Unit) &#x3D;&gt; {
      switch (unit) {
        case Unit.Wh:
          return 1;
        case Unit.kWh:
          return 10 ** 3;
        case Unit.MWh:
          return 10 ** 6;
        case Unit.GWh:
          return 10 ** 9;
      }
    };

    const multiplier &#x3D; getMultiplier(measurement.unit);

    return {
      reads: measurement.reads.map((r) &#x3D;&gt; ({
        starttimestamp: r.starttimestamp,
        endtimestamp: r.endtimestamp,
        value: Math.round(r.value * multiplier),
      })),
      unit: Unit.Wh,
      type: measurement.type,

    };
  }


  private async NewfilterMeasurements(
    deviceId: string,
    measurement: NewIntmediateMeterReadDTO,
    device: DeviceDTO,
  ): Promise&lt;MeasurementDTO&gt; {
    //@ts-ignore
    const final &#x3D; await this.NewfindLatestRead(deviceId, device.createdAt);
    console.log(&quot;final&quot;, final)
    let reads: any &#x3D; [];

    if (measurement.type &#x3D;&#x3D;&#x3D; &quot;History&quot;) {

      await new Promise((resolve, reject) &#x3D;&gt; {
        measurement.reads.forEach(async (element, measurmentreadindex) &#x3D;&gt; {

          const requeststartdate &#x3D; DateTime.fromISO(new Date(element.starttimestamp).toISOString());
          const requestcurrentend &#x3D; DateTime.fromISO(new Date(element.endtimestamp).toISOString());
          const meteredTimePeriod &#x3D; Math.abs(
            requeststartdate.diff(requestcurrentend, [&#x27;hours&#x27;]).toObject()?.hours || 0,
          );

          const checkhistroyreading &#x3D; await this.checkhistoryreadexist(device.externalId, element.starttimestamp, element.endtimestamp);
          // console.log(checkhistroyreading)
          //@ts-ignore
          const historyAge &#x3D; new Date(device.createdAt);
          historyAge.setFullYear(historyAge.getFullYear() - 3);
          console.log(&quot;historyAge&quot;);

          if (checkhistroyreading) {
            return reject(
              new ConflictException({
                success: false,
                message: &#x60;There are already one or more historical entries for this device which are conflicting current reading start date and/or end date &#x60;

              }),
            );
          }

          //@ts-ignore
          if (requeststartdate &lt;&#x3D; DateTime.fromISO(new Date(historyAge).toISOString()) ||
            //@ts-ignore
            requeststartdate &gt;&#x3D; DateTime.fromISO(new Date(device?.createdAt).toISOString()) ||
            requestcurrentend &lt;&#x3D; DateTime.fromISO(new Date(historyAge).toISOString()) ||
            //@ts-ignore
            requestcurrentend &gt;&#x3D; DateTime.fromISO(new Date(device?.createdAt).toISOString())) {

            return reject(
              new ConflictException({
                success: false,
                //@ts-ignore
                message: &#x60;For History Type Reads of devices start time and/or end time should be within 3 year of device onboarding, ex: device onboarded date: ${device?.createdAt}maximum date allowed for start and end date should be within 3 year in past from onboarded date, ${device?.createdAt}&#x60;

              }),
            );
          }

          // reads.push({
          //   timestamp: new Date(element.endtimestamp),
          //   value: element.value,
          //   timeperiod: meteredTimePeriod,
          //   startdate: requeststartdate,
          //   enddate: requestcurrentend
          // });
          let read: ReadDTO &#x3D; {
            timestamp: new Date(element.endtimestamp),
            value: element.value

          }
          const historyvalidation &#x3D; await this.NewhistoryvalidateEnergy(read, device, meteredTimePeriod, measurement, requeststartdate.toJSDate(), requestcurrentend.toJSDate())
          console.log(historyvalidation)
          if (historyvalidation) {
            reads.push({
              timestamp: new Date(element.endtimestamp),
              value: element.value,
            })
          } else {
            console.log(&quot;436&quot;)
            return reject(
              new ConflictException({
                success: false,
                message: &#x27;Failed,read value is greater than from MaxEnergy&#x27;
              }),
            );
          }
          if (measurmentreadindex &#x3D;&#x3D; measurement.reads.length - 1) {

            resolve(true);
          }

        })
      });
      return {
        reads: reads,
        unit: measurement.unit,

      };
    }
    else if (measurement.type &#x3D;&#x3D;&#x3D; &#x27;Delta&#x27;) {

      if (!final) {
        await new Promise((resolve, reject) &#x3D;&gt; {
          measurement.reads.forEach(async (element, measurmentreadindex) &#x3D;&gt; {

            if (final &amp;&amp; final[&#x27;timestamp&#x27;]) {

              //@ts-ignore
              if (new Date(element.endtimestamp).getTime() &lt; new Date(final.timestamp).getTime()) {
                return reject(
                  new ConflictException({
                    success: false,
                    message:
                      //@ts-ignore
                      &#x60;The sent date for reading ${element.endtimestamp} is less than last sent meter read date ${final.timestamp}&#x60;

                  }),
                );
              }
            }
            let read: ReadDTO &#x3D; {
              timestamp: new Date(element.endtimestamp),
              value: element.value
            }
            // if (deltafirstvalidation) {
            reads.push({
              timestamp: new Date(element.endtimestamp),
              value: element.value
            })
            await this.deltarepository.save({
              readsvalue: element.value,
              externalId: deviceId,
              unit: measurement.unit,
              readsEndDate: element.endtimestamp.toString()

            });
            // }

            if (measurmentreadindex &#x3D;&#x3D; measurement.reads.length - 1) {
              resolve(true);
            }
          })
        });
        await this.deviceService.updatereadtype(deviceId, measurement.type);
        return {
          reads: reads,
          unit: measurement.unit
        }
      } else {

        if (device?.meterReadtype !&#x3D; measurement.type &amp;&amp; device?.meterReadtype !&#x3D; null) {
          throw new NotFoundException(&#x60;In this device you can add read for ${device?.meterReadtype} type but you are sending  ${measurement.type}&#x60;);

        } else {
          await new Promise((resolve, reject) &#x3D;&gt; {
            measurement.reads.forEach((element, measurmentreadindex) &#x3D;&gt; {
              console.log(&quot;endtimestamp&quot;, element.endtimestamp);
              console.log(typeof element.endtimestamp);
              console.log(&quot;timestamp&quot;, final.timestamp);
              console.log(typeof final.timestamp);
              console.log(&quot;Stimestamp&quot;, final.timestamp.toISOString());
              console.log(typeof final.timestamp.toISOString());
              if (final &amp;&amp; final[&#x27;timestamp&#x27;]) {
                //@ts-ignore
                if (new Date(element.endtimestamp).getTime() &lt; new Date(final.timestamp).getTime()) {
                  return reject(
                    new ConflictException({
                      success: false,
                      message:
                        //@ts-ignore
                        &#x60;The sent date for reading ${element.endtimestamp} is less than last sent meter read date ${final.timestamp.toISOString()}&#x60;
                    }),
                  );
                }
              }
              // reads.push({
              //   timestamp: new Date(element.endtimestamp),
              //   value: element.value
              // })
              let read: ReadDTO &#x3D; {
                timestamp: new Date(element.endtimestamp),
                value: element.value
              }
              const newdeltavalidation &#x3D; this.NewvalidateEnergy(read, final, device);
              if (newdeltavalidation.success) {
                reads.push({
                  timestamp: new Date(element.endtimestamp),
                  value: element.value
                })

              } else {
                return reject(
                  new ConflictException({
                    success: false,
                    message: newdeltavalidation.message


                  }),
                );
              }
              if (measurmentreadindex &#x3D;&#x3D; measurement.reads.length - 1) {
                resolve(true);
              }
            })
          });
          return {
            reads: reads,
            unit: measurement.unit,
          };

        }
      }

    }
    else if (measurement.type &#x3D;&#x3D;&#x3D; &#x27;Aggregate&#x27;) {
      if (!final) {
        await new Promise((resolve, reject) &#x3D;&gt; {
          measurement.reads.forEach(async (element, measurmentreadindex) &#x3D;&gt; {
            const lastvalue &#x3D; await this.findlastRead(deviceId);
            let Delta &#x3D; 0;
            if (lastvalue.length &gt; 0) {
              Delta &#x3D; Math.abs(element.value - lastvalue[0].value);

              if (new Date(element.endtimestamp).getTime() &lt; new Date(lastvalue[0].datetime).getTime() || element.value &lt;&#x3D; lastvalue[0].value) {
                return reject(
                  new ConflictException({
                    success: false,
                    message:
                      &#x60;The sent date/value for reading ${element.endtimestamp}/${element.value} is less than last sent mter read date/value ${lastvalue[0].datetime}/${lastvalue[0].value} &#x60;

                  }),
                );
              }

              let read: ReadDTO &#x3D; {
                timestamp: new Date(element.endtimestamp),
                value: Delta
              }
              const firstvalidation &#x3D; this.firstvalidateEnergy(read, device)
              if (firstvalidation.success) {
                await this.repository.save({
                  value: element.value,
                  deltaValue: Delta,
                  externalId: deviceId,
                  unit: measurement.unit,
                  datetime: element.endtimestamp.toString()

                });
                reads.push({
                  timestamp: new Date(element.endtimestamp),
                  value: Delta
                })
              } else {
                return reject(
                  new ConflictException({
                    success: false,
                    message: firstvalidation.message


                  }),
                );
              }
            }
            else {
              let read: ReadDTO &#x3D; {
                timestamp: new Date(element.endtimestamp),
                value: element.value
              }
              const firstvalidation &#x3D; this.firstvalidateEnergy(read, device)
              if (firstvalidation.success) {
                await this.repository.save({
                  value: element.value,
                  deltaValue: Delta,
                  externalId: deviceId,
                  unit: measurement.unit,
                  datetime: element.endtimestamp.toString()

                });
              } else {
                return reject(
                  new ConflictException({
                    success: false,
                    message: firstvalidation.message


                  }),
                );
              }
            }
            if (measurmentreadindex &#x3D;&#x3D; measurement.reads.length - 1) {
              resolve(true);
            }
          })
        });
        await this.deviceService.updatereadtype(deviceId, measurement.type);
        return {
          reads: reads,
          unit: measurement.unit,
        };

      } else {
        if (device?.meterReadtype !&#x3D; measurement.type &amp;&amp; device?.meterReadtype !&#x3D; null) {
          throw new NotFoundException(&#x60;In this device you can add read for ${device?.meterReadtype} type but you are sending  ${measurement.type}&#x60;);
        }
        await new Promise((resolve, reject) &#x3D;&gt; {
          measurement.reads.forEach(async (element, measurmentreadindex) &#x3D;&gt; {

            const lastvalue &#x3D; await this.findlastRead(deviceId);
            let Delta;
            if (lastvalue.length &gt; 0) {
              Delta &#x3D; Math.abs(element.value - lastvalue[0].value);
              if (new Date(element.endtimestamp).getTime() &lt; new Date(lastvalue[0].datetime).getTime() || element.value &lt;&#x3D; lastvalue[0].value) {
                return reject(
                  new ConflictException({
                    success: false,
                    message:
                      &#x60;The sent date/value for reading ${element.endtimestamp}/${element.value} is less than last sent mter read date/value ${lastvalue[0].datetime}/${lastvalue[0].value} &#x60;

                  }),
                );
              }

              //@ts-ignore
              let read: ReadDTO &#x3D; {
                timestamp: new Date(element.endtimestamp),
                value: Delta
              }
              const newvalidation &#x3D; this.NewvalidateEnergy(read, final, device);
              if (newvalidation.success) {
                reads.push({
                  timestamp: new Date(element.endtimestamp),
                  value: Delta
                })
                await this.repository.save({
                  value: element.value,
                  deltaValue: Delta,
                  externalId: deviceId,
                  unit: measurement.unit,
                  datetime: element.endtimestamp.toString()

                });
              } else {
                return reject(
                  new ConflictException({
                    success: false,
                    message: newvalidation.message


                  }),
                );
              }

            }
            if (measurmentreadindex &#x3D;&#x3D; measurement.reads.length - 1) {
              resolve(true);
            }
          })
        });

        return {
          reads: reads,
          unit: measurement.unit,
        };

      }
    }


  }

  async NewfindLatestRead(meterId: string, deviceregisterdate: Date): Promise&lt;ReadDTO | void&gt; {

    //@ts-ignore
    const fluxQuery &#x3D; &#x60;from(bucket: &quot;${process.env.INFLUXDB_BUCKET}&quot;)
    |&gt; range(start: ${deviceregisterdate}, stop: now())
    |&gt; filter(fn: (r) &#x3D;&gt; r.meter &#x3D;&#x3D; &quot;${meterId}&quot; and r._field &#x3D;&#x3D; &quot;read&quot;)
    |&gt; last()&#x60;
    const reads &#x3D; await this.execute(fluxQuery);
    return reads[0];
  }

  async findLastReadForMeterWithinRange(meterId: string, startdate: Date, enddate: Date): Promise&lt;Array&lt;{ timestamp: Date, value: number }&gt;&gt; {

    const fluxQuery &#x3D; &#x60;from(bucket: &quot;${process.env.INFLUXDB_BUCKET}&quot;)
      |&gt; range(start: ${startdate.getTime()}, stop: ${enddate.getTime()})
      |&gt; filter(fn: (r) &#x3D;&gt; r.meter &#x3D;&#x3D; &quot;${meterId}&quot; and r._field &#x3D;&#x3D; &quot;read&quot;)
      |&gt; last()&#x60;;
    return await this.execute(fluxQuery);
  }

  async execute(query: any) {
    const data &#x3D; await this.dbReader.collectRows(query);
    return data.map((record: any) &#x3D;&gt; ({
      timestamp: new Date(record._time),
      value: Number(record._value),
    }));
  }
  get dbReader() {

    //@ts-ignore
    const url &#x3D; process.env.INFLUXDB_URL;
    //@ts-ignore
    const token &#x3D; process.env.INFLUXDB_TOKEN;
    //@ts-ignore
    const org &#x3D; process.env.INFLUXDB_ORG;

    //@ts-ignore
    return new InfluxDB({ url, token }).getQueryApi(org)
  }

  private async checkhistoryreadexist(
    deviceid: string,
    startDate: Date,
    endDate: Date

  ): Promise&lt;boolean&gt; {
    const query &#x3D; this.getexisthistorydevcielogFilteredQuery(deviceid,
      startDate,
      endDate);
    //console.log(&quot;historyexistdevicequery&quot;);
    try {

      const device &#x3D; await query.getRawMany();

      return device.length &gt; 0;
    } catch (error) {
      //console.log(error)
      this.logger.error(&#x60;Failed to retrieve device&#x60;, error.stack);
      //  throw new InternalServerErrorException(&#x27;Failed to retrieve users&#x27;);
    }

  }
  private getexisthistorydevcielogFilteredQuery(deviceid: string,
    startDate: Date,
    endDate: Date): SelectQueryBuilder&lt;HistoryIntermediate_MeterRead&gt; {
    console.log(startDate);
    console.log(endDate);

    //  const { organizationName, status } &#x3D; filterDto;
    const query &#x3D; this.historyrepository
      .createQueryBuilder(&quot;devicehistory&quot;).
      where(&quot;devicehistory.externalId &#x3D; :deviceid&quot;, { deviceid: deviceid })
      .andWhere(

        new Brackets((db) &#x3D;&gt; {
          db.where(&quot;devicehistory.readsStartDate BETWEEN :startDateFirstWhere AND :endDateFirstWhere &quot;, { startDateFirstWhere: startDate, endDateFirstWhere: endDate })
            .orWhere(&quot;devicehistory.readsEndDate BETWEEN :startDateSecondtWhere AND :endDateSecondWhere&quot;, { startDateSecondtWhere: startDate, endDateSecondWhere: endDate })
            .orWhere(&quot;:startdateThirdWhere BETWEEN devicehistory.readsStartDate AND devicehistory.readsEndDate&quot;, { startdateThirdWhere: startDate })
            .orWhere(&quot;:enddateforthdWhere BETWEEN devicehistory.readsStartDate AND devicehistory.readsEndDate&quot;, { enddateforthdWhere: endDate })

        }),
      )

    //console.log(query.getQuery())
    return query;
  }
  private firstvalidateEnergy(
    read: ReadDTO,
    device: DeviceDTO,

  ): { success: boolean; message: string } {
    const computeMaxEnergy &#x3D; (
      capacity: number,
      meteredTimePeriod: number,
      deviceAge: number,
      degradationPercentage: number,
      yieldValue: number,
    ) &#x3D;&gt; {
      // Max calculated energy formula
      // Old formula: Device capacity [kW] * metered time period [h] * device age [years] * degradation [%/year] * yield [kWh/kW]
      //New formula: Device capacity [kW]  * metered time period [h] * (Yield [kWh/kW] / 8760)* (1-degradation [%/year])^(device age [years] - 1)
      this.logger.debug(&quot;New formula: Device capacity [kW]  * metered time period [h] * (Yield [kWh/kW] / 8760)* (1-degradation [%/year])^(device age [years] - 1)&quot;)
      return (
        capacity * meteredTimePeriod * (yieldValue / 8760) * Math.pow((1 - degradationPercentage), deviceAge - 1)
      );
    };
    this.logger.debug(JSON.stringify(read))
    const degradation &#x3D; 0.5; // [%/year]
    const degradationPercentage &#x3D; degradation / 100;
    const yieldValue &#x3D; device.yieldValue || 2000; // [kWh/kW]
    const capacity &#x3D; device.capacity * 1000; // capacity in KilloWatt and read in Wh so coverting in Watt
    const commissioningDate &#x3D; DateTime.fromISO(device.commissioningDate);
    const currentDate &#x3D; DateTime.now();
    let deviceAge &#x3D;
      currentDate.diff(commissioningDate, [&#x27;years&#x27;]).toObject().years || 0; // years
    if (deviceAge &lt;&#x3D; 0) {
      deviceAge &#x3D; 1;
    }
    const currentRead &#x3D; DateTime.fromISO(read.timestamp.toISOString());

    //console.log(read.timestamp.toISOString());
    //@ts-ignore
    const lastRead &#x3D; DateTime.fromISO(new Date(device.createdAt).toISOString());
    //@ts-ignore
    //console.log(new Date(device.createdAt).toISOString());
    const meteredTimePeriod &#x3D; Math.abs(
      currentRead.diff(lastRead, [&#x27;hours&#x27;]).toObject()?.hours || 0,
    ); // hours

    // const margin &#x3D; 0.2; // Margin for comparing read value with computed max energy
    const maxEnergy &#x3D; computeMaxEnergy(
      capacity,
      meteredTimePeriod,
      deviceAge,
      degradationPercentage,
      yieldValue,
    );
    const finalmax &#x3D; maxEnergy * (120 / 100)
    this.logger.debug(
      &#x60;capacity: ${capacity}, meteredTimePeriod: ${meteredTimePeriod}, deviceAge: ${deviceAge}, degradation: ${degradation}, yieldValue: ${yieldValue}&#x60;,
    );
    this.logger.debug(&#x60;${read.value &lt; finalmax ? &#x27;Passed&#x27; : &#x27;Failed&#x27;}, MaxEnergy: ${finalmax}&#x60;,
    );
    console.log(&quot;hgfgfdt871&quot;, Math.round( read.value))
    if (read.value &lt; finalmax) {
      return {
        success: true,
        message: &#x27;Validation successful&#x27;,
      };
    } else {
      return {
        success: false,
        message: &#x60;Failed, MaxEnergy: ${finalmax}&#x60;,
      };
    }
  }
  private NewvalidateEnergy(
    read: ReadDTO,
    final: ReadDTO,
    device: DeviceDTO,

  ): { success: boolean; message: string } {
    const computeMaxEnergy &#x3D; (
      capacity: number,
      meteredTimePeriod: number,
      deviceAge: number,
      degradationPercentage: number,
      yieldValue: number,
    ) &#x3D;&gt; {
      // Max calculated energy formula
      // Old formula: Device capacity [kW] * metered time period [h] * device age [years] * degradation [%/year] * yield [kWh/kW]
      //New formula: Device capacity [kW]  * metered time period [h] * (Yield [kWh/kW] / 8760)* (1-degradation [%/year])^(device age [years] - 1)
      this.logger.debug(&quot;New formula: Device capacity [kW]  * metered time period [h] * (Yield [kWh/kW] / 8760)* (1-degradation [%/year])^(device age [years] - 1)&quot;)
      return (
        capacity * meteredTimePeriod * (yieldValue / 8760) * Math.pow((1 - degradationPercentage), deviceAge - 1)
      );
    };
    const degradation &#x3D; 0.5; // [%/year]
    const degradationPercentage &#x3D; degradation / 100;
    const yieldValue &#x3D; device.yieldValue || 2000; // [kWh/kW]
    const capacity &#x3D; device.capacity * 1000; // capacity in KilloWatt and read in Wh so coverting in Watt
    const commissioningDate &#x3D; DateTime.fromISO(device.commissioningDate);
    const currentDate &#x3D; DateTime.now();
    let deviceAge &#x3D;
      currentDate.diff(commissioningDate, [&#x27;years&#x27;]).toObject().years || 0; // years
    if (deviceAge &lt;&#x3D; 0) {
      deviceAge &#x3D; 1;
    }
    const currentRead &#x3D; DateTime.fromISO(read.timestamp.toISOString());
    const lastRead &#x3D; DateTime.fromISO(final.timestamp.toISOString());

    const meteredTimePeriod &#x3D; Math.abs(
      currentRead.diff(lastRead, [&#x27;hours&#x27;]).toObject()?.hours || 0,
    ); // hours

   // const margin &#x3D; 0.2; // Margin for comparing read value with computed max energy
    const maxEnergy &#x3D; computeMaxEnergy(
      capacity,
      meteredTimePeriod,
      deviceAge,
      degradationPercentage,
      yieldValue,
    );
    const finalmax &#x3D; maxEnergy * (120 / 100)
    this.logger.debug(
      &#x60;capacity: ${capacity}, meteredTimePeriod: ${meteredTimePeriod}, deviceAge: ${deviceAge}, degradation: ${degradation}, yieldValue: ${yieldValue}&#x60;,
    );
    this.logger.debug(&#x60;${read.value &lt; finalmax ? &#x27;Passed&#x27; : &#x27;Failed&#x27;}, MaxEnergy: ${finalmax}&#x60;,
    );
    //console.log(Math.round(read.value + margin * read.value) &lt; maxEnergy)
    if ( read.value&lt; finalmax) {
      return {
        success: true,
        message: &#x27;Validation successful&#x27;,
      };
    } else {
      return {
        success: false,
        message: &#x60;Failed, MaxEnergy: ${finalmax}&#x60;,
      };
    }

    // return Math.round(read.value + margin * read.value) &lt; maxEnergy;
  }

  async NewhistoryvalidateEnergy(
    read: ReadDTO,
    device: DeviceDTO,
    requestmeteredTimePeriod: number,
    measurement: NewIntmediateMeterReadDTO,
    startdate: Date,
    enddate: Date
  ): Promise&lt;boolean&gt; {
    const computeMaxEnergy &#x3D; (
      capacity: number,
      meteredTimePeriod: number,
      deviceAge: number,
      degradationPercentage: number,
      yieldValue: number,
    ) &#x3D;&gt; {
      // Max calculated energy formula
      // Old formula: Device capacity [kW] * metered time period [h] * device age [years] * degradation [%/year] * yield [kWh/kW]
      //New formula: Device capacity [kW]  * metered time period [h] * (Yield [kWh/kW] / 8760)* (1-degradation [%/year])^(device age [years] - 1)
      this.logger.debug(&quot;New formula: Device capacity [kW]  * metered time period [h] * (Yield [kWh/kW] / 8760)* (1-degradation [%/year])^(device age [years] - 1)&quot;)
      return (
        capacity * meteredTimePeriod * (yieldValue / 8760) * Math.pow((1 - degradationPercentage), deviceAge - 1)
      );
    };

    this.logger.debug(JSON.stringify(read))
    const degradation &#x3D; 0.5; // [%/year]
    const degradationPercentage &#x3D; degradation / 100;
    const yieldValue &#x3D; device.yieldValue || 2000; // [kWh/kW]
    const capacity &#x3D; device.capacity * 1000; // capacity in KilloWatt and read in Wh so coverting in Watt 
    const commissioningDate &#x3D; DateTime.fromISO(device.commissioningDate);
    const currentDate &#x3D; DateTime.now();
    let deviceAge &#x3D;
      currentDate.diff(commissioningDate, [&#x27;years&#x27;]).toObject().years || 0; // years
    if (deviceAge &lt;&#x3D; 0) {
      deviceAge &#x3D; 1;
    }
    const meteredTimePeriod &#x3D; requestmeteredTimePeriod;

    //const margin &#x3D; 0.2; // Margin for comparing read value with computed max energy
    const maxEnergy &#x3D; computeMaxEnergy(
      capacity,
      meteredTimePeriod,
      deviceAge,
      degradationPercentage,
      yieldValue,
    );
    const finalmax &#x3D; maxEnergy * (120 / 100)
    this.logger.debug(
      &#x60;capacity: ${capacity}, meteredTimePeriod: ${meteredTimePeriod}, deviceAge: ${deviceAge}, degradation: ${degradation}, yieldValue: ${yieldValue}&#x60;,
    );
    this.logger.debug(&#x60;${read.value &lt; finalmax ? &#x27;Passed&#x27; : &#x27;Failed&#x27;}, MaxEnergy: ${finalmax}&#x60;,
    );
   
   
    if ( read.value&lt; finalmax) {
      this.historyrepository.save({
        type: measurement.type,
        externalId: device.externalId,
        unit: measurement.unit,
        readsvalue: read.value,
        readsStartDate: startdate,
        readsEndDate: enddate
      })
      console.log(&quot;1267&quot;);
      if (device.groupId !&#x3D; null) {
        const historynextissue &#x3D; await this.deviceGroupService.getNextHistoryissuanceDevicelogafterreservation(
          device.externalId,
          device.groupId
        );
        console.log(&quot;historynextissue&quot;);
        if (historynextissue !&#x3D; undefined) {
          let stdate &#x3D; new Date(startdate).getTime();
          let eddate &#x3D; new Date(enddate).getTime();
          //@ts-ignore
          let reservSdate &#x3D; new Date(historynextissue.reservationStartDate).getTime();
          console.log(reservSdate);
          //@ts-ignore
          let reservEdate &#x3D; new Date(historynextissue.reservationEndDate).getTime();
          console.log(reservEdate);
          console.log((stdate &gt;&#x3D; reservSdate &amp;&amp; stdate &lt; reservEdate));
          console.log(eddate &lt;&#x3D; reservEdate &amp;&amp; eddate &gt; reservSdate);
          if ((stdate &gt;&#x3D; reservSdate &amp;&amp; stdate &lt; reservEdate) &amp;&amp; (eddate &lt;&#x3D; reservEdate &amp;&amp; eddate &gt; reservSdate)) {
            //@ts-ignore
            this.deviceGroupService.HistoryUpdatecertificateissuedate(historynextissue.id, HistoryNextInssuanceStatus.Pending);
          }

        }

      }
      return  read.value &lt; finalmax;
    } else {
      return false;
      // throw new ConflictException({
      //   success: false,
      //   message: &#x60;${read.value + margin * read.value &lt; finalmax ? &#x27;Passed&#x27; : &#x27;Failed&#x27;}, MaxEnergy: ${finalmax}&#x60;,
      // });
    }

  }


  private async newstoreGenerationReading(
    id: string,
    measurements: MeasurementDTO,
    device: DeviceDTO,
  ): Promise&lt;void&gt; {
    const organization &#x3D; await this.organizationService.findOne(
      device.organizationId,
    );

    if (!organization) {
      throw new NotFoundException(
        &#x60;No organization found with device organization code ${device.organizationId}&#x60;,
      );
    }

    //console.log(&quot;new store&quot;)
    await this.store(id, measurements);

    for (const measurement of measurements.reads) {
      const startTime &#x3D; DateTime.fromJSDate(measurement.timestamp)
        .minus({ minutes: 30 })
        .toJSDate();
      const endTime &#x3D; DateTime.fromJSDate(measurement.timestamp).toJSDate();

      this.eventBus.publish(
        new GenerationReadingStoredEvent({
          deviceId: id,
          energyValue: BigNumber.from(measurement.value),
          fromTime: startTime,
          toTime: endTime,
          organizationId: organization.id.toString(),
        }),
      );
    }
  }

  private aggregateArray(aggregate: Aggregate, array: number[]): number {
    switch (aggregate) {
      case Aggregate.Mean:
        return Math.floor(mean(array));
      case Aggregate.Sum:
        return Math.floor(sum(array));
    }
  }
  public async getCheckHistoryCertificateIssueDateLogForDevice(deviceid: string,
    startDate: Date,
    endDate: Date): Promise&lt;HistoryIntermediate_MeterRead[]&gt; {
    const query &#x3D; this.gethistorydevcielogFilteredQuery(deviceid,
      startDate,
      endDate);
    //console.log(&quot;devicequery&quot;);
    try {

      const device &#x3D; await query.getRawMany();
      // console.log(device);
      const devices &#x3D; device.map((s: any) &#x3D;&gt; {
        const item: any &#x3D; {
          id: s.devicehistory_id,
          readsStartDate: s.devicehistory_readsStartDate,
          readsEndDate: s.devicehistory_readsEndDate,
          readsvalue: s.devicehistory_readsvalue,
          externalId: s.devicehistory_externalId
        };
        return item;
      });

      return devices;
    } catch (error) {
      //console.log(error)
      this.logger.error(&#x60;Failed to retrieve device&#x60;, error.stack);
      //  throw new InternalServerErrorException(&#x27;Failed to retrieve users&#x27;);
    }
  }

  private gethistorydevcielogFilteredQuery(deviceid: string,
    startDate: Date,
    endDate: Date): SelectQueryBuilder&lt;HistoryIntermediate_MeterRead&gt; {
    //  const { organizationName, status } &#x3D; filterDto;
    const query &#x3D; this.historyrepository
      .createQueryBuilder(&quot;devicehistory&quot;).
      where(&quot;devicehistory.externalId &#x3D; :deviceid&quot;, { deviceid: deviceid })
      .andWhere(
        new Brackets((db) &#x3D;&gt; {
          db.where(
            new Brackets((db1) &#x3D;&gt; {
              db1.where(&quot;devicehistory.readsStartDate BETWEEN :reservationStartDate1  AND :reservationEndDate1&quot;, { reservationStartDate1: startDate, reservationEndDate1: endDate })
                .orWhere(&quot;devicehistory.readsStartDate &#x3D; :reservationStartDate&quot;, { reservationStartDate: startDate })
            })
          )
            .andWhere(
              new Brackets((db2) &#x3D;&gt; {
                db2.where(&quot;devicehistory.readsEndDate  BETWEEN :reservationStartDate2  AND :reservationEndDate2&quot;, { reservationStartDate2: startDate, reservationEndDate2: endDate })
                  .orWhere(&quot;devicehistory.readsEndDate &#x3D; :reservationEndDate &quot;, { reservationEndDate: endDate })
              })
            )

        }),
      )
      .andWhere(&quot;devicehistory.certificate_issued !&#x3D; true&quot;)
    // //console.log(query.getQuery())
    return query;
  }

  async getDeviceHistoryCertificateIssueDate(
    conditions: FindConditions&lt;HistoryIntermediate_MeterRead&gt;,
  ): Promise&lt;HistoryIntermediate_MeterRead | null&gt; {
    return (await this.historyrepository.findOne(conditions)) ?? null;
  }
  async updatehistorycertificateissuedate(
    id: number,
    startdate: Date,
    enddate: Date,
  ): Promise&lt;HistoryIntermediate_MeterRead&gt; {
    // await this.checkNameConflict(data.name);
    const historydevice &#x3D; await this.getDeviceHistoryCertificateIssueDate({ id: id });
    let updatedhistoryissue &#x3D; new HistoryIntermediate_MeterRead();
    if (historydevice) {

      historydevice.certificate_issuance_startdate &#x3D; startdate;
      historydevice.certificate_issuance_enddate &#x3D; enddate;
      historydevice.certificate_issued &#x3D; true;
      updatedhistoryissue &#x3D; await this.historyrepository.save(historydevice);
    }
    return updatedhistoryissue;
  }
  async getAggregateMeterReadsFirstEntryOfDevice(meterId: string): Promise&lt;AggregateMeterRead[]&gt; {

    return this.repository.find({
      where: {
        externalId: meterId
      },
      take: 1
    })


  }
  // add new function for Delta firstread filter
  async getDeltaMeterReadsFirstEntryOfDevice(meterId: string): Promise&lt;DeltaFirstRead[]&gt; {

    return this.deltarepository.find({
      where: {
        externalId: meterId
      }
    })
  }

  /* */

  timeOffset: any;
  async getAllRead(externalId, filter, deviceOnboarded, pageNumber: number): Promise&lt;any&gt; {
    if (new Date(filter.start).getTime() &#x3D;&#x3D; new Date(filter.end).getTime()) {
      throw new HttpException(&#x27;The given start and end timestamps are the same&#x27;, 400)
    }
    let historyread &#x3D; [];
    let ongoing &#x3D; [];
    let finalongoing &#x3D; [];
    console.log(&quot;page number:::::::::::::::::::::::::::::::::::::::::::&quot; + pageNumber)

    let sizeOfPage &#x3D; 5;
    let numberOfPages &#x3D; 0;
    let numberOfHistReads &#x3D; await this.getnumberOfHistReads(externalId, filter.start, filter.end);
    let numberOfOngReads &#x3D; 0;
    let numberOfReads &#x3D; numberOfHistReads + numberOfOngReads;
    if (numberOfHistReads &gt; 0) {
      numberOfPages &#x3D; Math.ceil(numberOfHistReads / sizeOfPage);
    }
    //@ts-ignore

    if (typeof pageNumber &#x3D;&#x3D;&#x3D; &#x27;number&#x27; &amp;&amp; !isNaN(pageNumber)) {
      filter.offset &#x3D; sizeOfPage * (pageNumber - 1);
      filter.limit &#x3D; sizeOfPage;
    }
    numberOfOngReads &#x3D; await this.getnumberOfOngReads(filter.start, filter.end, externalId, deviceOnboarded);
    console.log(numberOfOngReads);
    if (numberOfOngReads &gt; numberOfHistReads) {
      numberOfPages &#x3D; Math.ceil(numberOfOngReads / sizeOfPage);
    }
    numberOfReads &#x3D; numberOfHistReads + numberOfOngReads;
    // numberOfPages&#x3D;Math.ceil(numberOfReads/sizeOfPage)
    if (numberOfHistReads &#x3D;&#x3D; 0 &amp;&amp; numberOfOngReads &#x3D;&#x3D; 0) {

      return { historyread, ongoing, &quot;numberOfReads&quot;: numberOfReads, &quot;numberOfPages&quot;: 0, &quot;currentPageNumber&quot;: 0 }
    }
    if ((typeof pageNumber &#x3D;&#x3D;&#x3D; &#x27;number&#x27; &amp;&amp; !isNaN(pageNumber)) &amp;&amp; pageNumber &gt; numberOfPages) {

      return { historyread, ongoing, &quot;numberOfReads&quot;: numberOfReads, &quot;numberOfPages&quot;: numberOfPages, &quot;currentPageNumber&quot;: 1 };
    }

    //if ((new Date(filter.start).getTime() &lt;&#x3D; new Date(deviceOnboarded).getTime() &amp;&amp; new Date(filter.end).getTime() &lt;&#x3D; new Date(deviceOnboarded).getTime()) || (filter.start &lt;&#x3D; device_onboarded &amp;&amp; filter.end &gt; device_onboarded)) {

    if (new Date(filter.start).getTime() &lt;&#x3D; new Date(deviceOnboarded).getTime()) {

      const query &#x3D; await this.getexisthistorydevcielogFilteredQuery(externalId, filter.start, filter.end);

      console.log(&quot;history query executed!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&quot;);
      console.log(&quot;historyexistdevicequery&quot;);
      try {
        const histroread &#x3D; await query.limit(filter.limit).offset(filter.offset).getRawMany();
        //console.log(&quot;histroread&quot;, histroread);
        await histroread.forEach(element &#x3D;&gt; {

          historyread.push({
            startdate: element.devicehistory_readsStartDate,
            enddate: element.devicehistory_readsEndDate,
            value: element.devicehistory_readsvalue
          })

        })
      } catch (error) {
        console.log(error)
        this.logger.error(&#x60;Failed to retrieve device&#x60;, error.stack);
      }
    }
    // console.log(&quot;1513&quot;)
    //console.log(deviceOnboarded);
    // console.log(filter.end);
    if (new Date(deviceOnboarded).getTime() &lt; new Date(filter.end).getTime()) {
      console.log(&quot;offset::::::::::::&quot; + filter.offset + &quot;\nlimit:::::::::::::&quot; + filter.limit + &quot;\n device onboarded::::::::::&quot; + deviceOnboarded.toString() + &quot;\nend:::::::::&quot; + filter.end.toString())

      let readsFilter: FilterDTO &#x3D; {

        offset: filter.offset,
        limit: filter.limit,
        start: filter.start.toString(),
        end: filter.end.toString(),
      };
      if (new Date(filter.start).getTime() &gt; new Date(deviceOnboarded).getTime()) {
        readsFilter &#x3D; {
          offset: filter.offset,
          limit: filter.limit,
          start: filter.start.toString(),
          end: filter.end.toString(),
        };
      }
      else {
        readsFilter &#x3D; {
          offset: filter.offset,
          limit: filter.limit,
          start: deviceOnboarded,
          end: filter.end.toString(),
        };
      }

      //  console.log(&quot;device onboarded:::::::::&quot; + deviceOnboarded + &quot;\nend:::::::::::::::::&quot; + filter.end);

      if (new Date(filter.start).getTime() &lt; new Date(deviceOnboarded).getTime() || new Date(filter.end).getTime() &gt; new Date(deviceOnboarded).getTime()) {
        let finalongoing &#x3D; await this.getPaginatedData(externalId, readsFilter, pageNumber);
        //console.log(&quot;final ongoing:::::::&quot;, finalongoing);

        // const nextPage &#x3D; pageNumber + 1;

        // const nextPageData &#x3D; await this.getPaginatedData(externalId, readsFilter, nextPage);

        // let nextReadTime;

        // if (nextPageData.length &gt; 0) {
        //   // @ts-ignore
        //   nextReadTime &#x3D; nextPageData[0].timestamp;
        // } else {
        //   nextReadTime &#x3D; null;
        // }
        let previousReadTime;
        if (pageNumber &gt; 1) {
          const previousPage &#x3D; pageNumber - 1;
          const previousPageData &#x3D; await this.getPaginatedData(externalId, readsFilter, previousPage);
          if (previousPageData.length &gt; 0) {
            // @ts-ignore
            previousReadTime &#x3D; previousPageData[0].timestamp;
            // @ts-ignore
            console.log(&quot;previous page read data[0]::::&quot; + previousPageData[0].timestamp);
          } else {
            previousReadTime &#x3D; null;
          }
        }
        const transformedFinalOngoing &#x3D; [];
        for (let i &#x3D; 0; i &lt; finalongoing.length; i++) {
          const currentRead &#x3D; finalongoing[i];
          let startdate;
          if (i &#x3D;&#x3D;&#x3D; 0 &amp;&amp; pageNumber &#x3D;&#x3D; 1) {
            startdate &#x3D; new Date(Math.max(new Date(deviceOnboarded).getTime(), new Date(filter.start).getTime()));
          } else if (i &#x3D;&#x3D; 0 &amp;&amp; pageNumber !&#x3D; 1) {
            // @ts-ignore
            startdate &#x3D; previousReadTime;
          }
          else {
            startdate &#x3D; transformedFinalOngoing[i - 1].enddate;
          }
          // @ts-ignore
          const enddate &#x3D; finalongoing[i].timestamp;
          if (i &gt; 1) {
            transformedFinalOngoing.push({
              startdate: transformedFinalOngoing[i - 1].enddate,
              enddate: enddate,
              // @ts-ignore
              value: currentRead.value
            });
          }
          else {
            transformedFinalOngoing.push({
              startdate: startdate,
              enddate: enddate,
              //@ts-ignore
              value: currentRead.value
            });
          }
        }
        ongoing &#x3D; transformedFinalOngoing;
      }
    }
    //  console.log(ongoing);
    console.log(&quot;count of ong reads:::::::::::::::::::::::::::::::::::&quot; + await this.getnumberOfOngReads(filter.start, filter.end, externalId, deviceOnboarded))
    if (typeof pageNumber &#x3D;&#x3D;&#x3D; &#x27;number&#x27; &amp;&amp; !isNaN(pageNumber)) {

      return { historyread, ongoing, &quot;numberOfReads&quot;: numberOfReads, &quot;numberOfPages&quot;: numberOfPages, &quot;currentPageNumber&quot;: pageNumber };
    }
    else {
      return { historyread, ongoing, &quot;numberOfReads&quot;: numberOfReads, &quot;numberOfPages&quot;: numberOfPages, &quot;currentPageNumber&quot;: 1 };
    }


  }

  async getnumberOfHistReads(deviceId, startDate, endDate) {
    const query &#x3D; this.historyrepository.createQueryBuilder(&quot;devicehistory&quot;)
      .where(&quot;devicehistory.externalId &#x3D; :deviceId&quot;, { deviceId })
      .andWhere(&quot;devicehistory.readsStartDate &lt;&#x3D; :endDate&quot;, { endDate })
      .andWhere(&quot;devicehistory.readsEndDate &gt;&#x3D; :startDate&quot;, { startDate });

    const count &#x3D; await query.getCount();
    return count;
  }


  async getnumberOfOngReads(start: Date, end: Date, externalId, onboarded: Date) {
    console.log(externalId)
    if (new Date(onboarded).getTime() &gt; new Date(end).getTime()) {
      console.log(&#x27;The given dates are not for on-going reads&#x27;)
      return 0;
    }
    let fluxquery &#x3D; &#x60;&#x60;;
    if (new Date(start).getTime() &gt; new Date(onboarded).getTime()) {
      fluxquery &#x3D; &#x60;from(bucket: &quot;${process.env.INFLUXDB_BUCKET}&quot;)
  |&gt; range(start: ${start}, stop: ${end})
  |&gt; filter(fn: (r) &#x3D;&gt; r._measurement &#x3D;&#x3D; &quot;read&quot; and r.meter &#x3D;&#x3D; &quot;${externalId}&quot;)
  |&gt; count()&#x60;;
    }

    else {
      fluxquery &#x3D; &#x60;from(bucket: &quot;${process.env.INFLUXDB_BUCKET}&quot;)
  |&gt; range(start: ${onboarded}, stop: ${end})
  |&gt; filter(fn: (r) &#x3D;&gt; r._measurement &#x3D;&#x3D; &quot;read&quot;and r.meter &#x3D;&#x3D; &quot;${externalId}&quot;)
  |&gt; count()&#x60;;
    }
    let noOfReads &#x3D; await this.ongExecute(fluxquery);

    return noOfReads;
  }


  async ongExecute(query: any) {
    const data: any &#x3D; await this.dbReader.collectRows(query);
    if (typeof data[0] &#x3D;&#x3D;&#x3D; &#x27;undefined&#x27; || data.length &#x3D;&#x3D; 0) {
      console.log(&quot;type of data is undefined&quot;)
      return 0;
    }
    return Number(data[0]._value);
  }


  async latestread(meterId, deviceOnboarded) {
    let query &#x3D; &#x60;
from(bucket: &quot;${process.env.INFLUXDB_BUCKET}&quot;)
|&gt; range(start: ${deviceOnboarded}, stop: now())
|&gt; filter(fn: (r) &#x3D;&gt; r.meter &#x3D;&#x3D; &quot;${meterId}&quot; and r._field &#x3D;&#x3D; &quot;read&quot;)
|&gt; last()
&#x60;;

    return await this.execute(query);
  }
  /* */

  async getAccumulatedReads(meter: string, organizationId, developerExternalId, accumulationType, month: number, year: number) {
    let startDate;
    let numberOfDays;
    let endDate;
    if (month &amp;&amp; year) {
      startDate &#x3D; this.convertToISODate(month, year);
      numberOfDays &#x3D; this.getNumberOfDaysInMonth(month, year);
      endDate &#x3D; DateTime.fromISO(startDate).plus({ days: numberOfDays }).minus({ seconds: 1 }).toISODate() + &quot;T00:00:00Z&quot;;
    }
    if (year &amp;&amp; !month) {
      month &#x3D; 1;
      startDate &#x3D; this.convertToISODate(month, year);
      console.log(&quot;startDate for year:::::::::::::&quot; + startDate);

      endDate &#x3D; DateTime.fromISO(startDate)
        .plus({ years: 1 })
        .minus({ seconds: 1 })
        .toISO({ suppressMilliseconds: true, includeOffset: false }) + &quot;Z&quot;;

    }
    console.log(&quot;startDate::::::::::::&quot; + startDate);
    console.log(&quot;End DAte:::::::::::::&quot; + endDate);

    meter &#x3D; meter;
    let tempResults &#x3D; [];
    let finalResults: { timestamp?: string, value?: any }[] &#x3D; [];
    let response;
    let url;
    const offSet &#x3D; await this.getOffSetForInfluxQuery(developerExternalId, organizationId, startDate);
    console.log(&quot;THE OFFSET RETURNED:::&quot; + offSet);

    const formattedOffSet &#x3D; offSet.formattedOffset;

    const monthlyQuery &#x3D; &#x60;SELECT time, SUM(&quot;read&quot;) AS total_meter_reads FROM &quot;read&quot; WHERE time &gt;&#x3D; &#x27;${startDate}&#x27; AND time &lt; &#x27;${endDate}&#x27;  AND meter &#x3D; &#x27;${meter}&#x27;GROUP BY time(1d,${formattedOffSet})&#x60;;
    const yearlyQuery &#x3D; &#x60;SELECT time, SUM(&quot;read&quot;) AS total_meter_reads FROM &quot;read&quot; WHERE time &gt;&#x3D; &#x27;${startDate}&#x27; AND time &lt; &#x27;${endDate}&#x27;  AND meter &#x3D; &#x27;${meter}&#x27;GROUP BY time(30d,${formattedOffSet})&#x60;;
    console.log(&quot;accumulation type:::::::::::::::::&quot; + accumulationType);
    if (accumulationType &#x3D;&#x3D;&#x3D; &#x27;Monthly&#x27; &amp;&amp; month &amp;&amp; year) {
      url &#x3D; &#x60;${process.env.INFLUXDB_URL}/query?db&#x3D;${process.env.INFLUXDB_DB}&amp;q&#x3D;${monthlyQuery}&#x60;;
    }

    else if (accumulationType &#x3D;&#x3D;&#x3D; &#x27;Yearly&#x27; &amp;&amp; year) {
      url &#x3D; &#x60;${process.env.INFLUXDB_URL}/query?db&#x3D;${process.env.INFLUXDB_DB}&amp;q&#x3D;${yearlyQuery}&#x60;;
    }

    else {
      throw new HttpException(&#x27;Invalid accumulationType&#x27;, HttpStatus.BAD_REQUEST);
    }

    const config &#x3D; {
      auth: {
        username: &#x60;${process.env.INFLUXDB_ADMIN_USER}&#x60;,
        password: &#x60;${process.env.INFLUXDB_ADMIN_PASSWORD}&#x60;,
      },
    };

    try {
      response &#x3D; await axios.get(url, config);

      if (!response) {
        throw new HttpException(&#x27;Some Error occured&#x27;, HttpStatus.AMBIGUOUS);
      }


      if (!response.data.results[0].series) {
        throw new HttpException(&#x27;No reads found&#x27;, HttpStatus.CONFLICT);
      }
      tempResults &#x3D; this.readFilterNullUndefined(response.data.results[0].series[0].values)
    } catch (error) {
      console.error(error);
      throw error;
    }



    for (let i &#x3D; 0; i &lt; tempResults.length; i++) {
      let resultObj: { startTime?: string, endTime?: string, value?: any } &#x3D; {};
      for (let j &#x3D; 0; j &lt; 2; j++) {
        if (j % 2 &#x3D;&#x3D;&#x3D; 0) {
          const startDateStr &#x3D; new Date(tempResults[i][j]).getTime();
          const startDate &#x3D; new Date(startDateStr);
          const isoStartDateStr &#x3D; startDate.toISOString();
          resultObj.startTime &#x3D; isoStartDateStr;
        } else {
          resultObj.value &#x3D; tempResults[i][j];
          if (i &lt; tempResults.length - 1) {
            const endDateStr &#x3D; new Date(tempResults[i + 1][j - 1]).getTime();
            const endDate &#x3D; new Date(endDateStr);
            const isoEndDateStr &#x3D; endDate.toISOString();
            resultObj.endTime &#x3D; isoEndDateStr;
          } else {
            resultObj.endTime &#x3D; endDate;
          }
        }
      }

      finalResults.push(resultObj);
    }
    console.log(finalResults);
    return { &#x27;aggregateType&#x27;: accumulationType, &#x27;accumulatedReads&#x27;: finalResults, &#x27;timezone&#x27;: offSet.localTimeZone };
  }

  readFilterNullUndefined(arr) {
    for (let i &#x3D; 0; i &lt; arr.length; i++) {

      for (let j &#x3D; 0; j &lt; 2; j++) {
        if (j % 2 !&#x3D; 0) {
          if ((arr[i])[j] &#x3D;&#x3D; null || (arr[i])[j] &#x3D;&#x3D; undefined) {
            (arr[i])[j] &#x3D; 0;
          }
        }
      }

    }
    return arr;
  }


  convertToISODate(month, year) {
    const isoDate &#x3D; DateTime.fromObject({
      year: year,
      month: month,
      day: 1,
      hour: 0,
      minute: 0,
      second: 0,
      zone: &#x27;utc&#x27;
    }).toISO({ suppressMilliseconds: true });

    return isoDate;
  }

  getNumberOfDaysInMonth(month, year) {
    return DateTime.fromObject({
      year: year,
      month: month,
      day: 1,
      hour: 0,
      minute: 0,
      second: 0
    }).daysInMonth;
  }

  //  @Cron(CronExpression.EVERY_10_SECONDS)
  //  async  addOffSetToStartAndEndDates(externalId,organizationId,startDate,endDate)
  //   {     

  //     let device &#x3D; await this.deviceService.findDeviceByDeveloperExternalId(externalId, organizationId);
  //     console.log(&quot;DEVICE:::::::::::&quot;+device)


  //       console.log(&quot;THIS IS THE LAT &quot;+device.latitude+&quot;AND LONG&quot;+device.longitude);
  //       const localTime&#x3D;getLocalTime(startDate,device);//timezone of the device.
  //       console.log(&quot;calling the localtimezone function&quot;)
  //       const localTimeZone&#x3D;getLocalTimeZoneFromDevice(localTime,device);
  //       console.log(&quot;calling the offset function&quot;);
  //       const nonFormattedOffSet&#x3D;getOffsetFromTimeZoneName(localTimeZone);
  //       const offset&#x3D;getFormattedOffSetFromOffsetAsJson(nonFormattedOffSet);
  //       console.log(&quot;FINAL OFFSET HOURS::::::&quot;+offset.hours);
  //       console.log(&quot;FINAL OFFSET MINUTES::::::&quot;+offset.minutes);


  //   const parsedStartDate &#x3D; new Date(startDate);
  //   const parsedEndDate &#x3D; new Date(endDate);

  //   parsedStartDate.setUTCHours(parsedStartDate.getUTCHours() + offset.hours);
  //   parsedStartDate.setUTCMinutes(parsedStartDate.getUTCMinutes() + offset.minutes);
  //   parsedEndDate.setUTCHours(parsedEndDate.getUTCHours() + offset.hours);
  //   parsedEndDate.setUTCMinutes(parsedEndDate.getUTCMinutes() + offset.minutes);

  //   const updatedStartDate &#x3D; parsedStartDate.toISOString();
  //   const updatedEndDate &#x3D; parsedEndDate.toISOString();

  //     console.log(&quot;UPDATED START DATE::::&quot;+updatedStartDate);
  //     console.log(&quot;UPDATED END DATE::::::::::&quot;+updatedEndDate);

  //   return {
  //     &quot;startDate&quot;:updatedStartDate,
  //     &quot;endDate&quot;:updatedEndDate
  //   }

  //   }


  async getPaginatedData(meter: string, filter: any, page: number): Promise&lt;unknown[]&gt; {
    console.log(&quot;page: &quot; + page);
    const pageSize &#x3D; filter.limit;
    const skipCount &#x3D; (page - 1) * pageSize;
    const data &#x3D; await this.retrieveDataWithLastValue(meter, filter, skipCount, pageSize);
    console.log(&quot;data:&quot;, data);
    return data;
  }

  async retrieveDataWithLastValue(meter: string, filter: any, skipCount: number, pageSize: number): Promise&lt;unknown[]&gt; {
    let currentQuery: string;

    if (filter.lastValue) {
      let newDateTime &#x3D; new Date(new Date(filter.lastValue).getTime() + 1000).toISOString();
      currentQuery &#x3D; &#x60;from(bucket: &quot;${process.env.INFLUXDB_BUCKET}&quot;)
    |&gt; range(start: ${newDateTime}, stop: ${filter.end})
    |&gt; filter(fn: (r) &#x3D;&gt; r.meter &#x3D;&#x3D; &quot;${meter}&quot; and r._field &#x3D;&#x3D; &quot;read&quot;)
    |&gt; drop(columns: [&quot;_start&quot;, &quot;_stop&quot;])
    |&gt; limit(n: ${pageSize}, offset: ${skipCount})&#x60;;
    } else {
      currentQuery &#x3D; &#x60;from(bucket: &quot;${process.env.INFLUXDB_BUCKET}&quot;)
    |&gt; range(start: ${filter.start}, stop: ${filter.end})
    |&gt; filter(fn: (r) &#x3D;&gt; r.meter &#x3D;&#x3D; &quot;${meter}&quot; and r._field &#x3D;&#x3D; &quot;read&quot;)
    |&gt; drop(columns: [&quot;_start&quot;, &quot;_stop&quot;])
    |&gt; limit(n: ${pageSize}, offset: ${skipCount})&#x60;;
    }

    const org &#x3D; process.env.INFLUXDB_ORG;
    const url &#x3D; process.env.INFLUXDB_URL;
    const token &#x3D; process.env.INFLUXDB_TOKEN;

    const influxDB &#x3D; new InfluxDB({ url, token });
    const queryApi &#x3D; influxDB.getQueryApi(org);
    const result &#x3D; await influxDB.getQueryApi(org).collectRows(currentQuery);

    return result.map((record: any) &#x3D;&gt; ({
      timestamp: new Date(record._time),
      value: Number(record._value),
    }));
  }


  //
  async getOffSetForInfluxQuery(developerExternalId, organizationId, startDate) {

    let localTime &#x3D; null;
    let formattedOffset &#x3D; null;
    let device &#x3D; await this.deviceService.findDeviceByDeveloperExternalId(developerExternalId, organizationId);
    // console.log(&quot;DEVICE:::::::::::&quot; + device);
    if (device.latitude &amp;&amp; device.longitude) {
      // console.log(&quot;THIS IS THE LAT &quot; + device.latitude + &quot;AND LONG&quot; + device.longitude);
      // console.log(&quot;calling the localtimezone function&quot;);
      localTime &#x3D; getLocalTime(startDate, device);
    }

    const localTimeZone &#x3D; getLocalTimeZoneFromDevice(localTime, device);
    // console.log(&quot;localTimeZone:::::&quot; + localTimeZone);
    // console.log(&quot;calling the offset function&quot;);
    const localTimeZoneName &#x3D; localTimeZone;
    // console.log(&quot;TIME ZONE BEING SENT::::&quot; + localTimeZoneName);
    const nonFormattedOffSet &#x3D; getOffsetFromTimeZoneName(localTimeZoneName);
    const offset &#x3D; getFormattedOffSetFromOffsetAsJson(nonFormattedOffSet);
    // console.log(&quot;FINAL OFFSET HOURS::::::&quot; + typeof (offset.hours));
    // console.log(&quot;FINAL OFFSET MINUTES::::::&quot; + typeof (offset.minutes));

    const offSetHoursString &#x3D; (offset.hours).toString();
    const offSetMinutesString &#x3D; (offset.minutes).toString();

    formattedOffset &#x3D; offSetHoursString + &#x27;h&#x27; + offSetMinutesString + &#x27;m&#x27;;

    console.log(&quot;FORMATTED OFFSET BEING RETURNED:::&quot; + formattedOffset);

    return { &#x27;formattedOffset&#x27;: formattedOffset, &#x27;offSetHours&#x27;: offset.hours, &#x27;offSetMinutes&#x27;: offset.minutes, &#x27;localTimeZone&#x27;: localTimeZoneName };

  }


  async getOngoingReads(meter, filter): Promise&lt;any&gt; {

    console.log(&quot;IN THE FUNCTION TO GET ONGOING READS&quot;);

    const url &#x3D; process.env.INFLUXDB_URL;
    const token &#x3D; process.env.INFLUXDB_TOKEN;
    const org &#x3D; process.env.INFLUXDB_ORG;
    const queryApi &#x3D; new InfluxDB({ url, token }).getQueryApi(org);
    console.log(&#x27;filter.start:::::::&#x27; + filter);
    // console.log(&#x27;filter.end:::::::::&#x27; + filter.end);
    // console.log(&#x27;filter.limit:::::::&#x27; + filter.limit);
    // console.log(&#x27;filter.offset:::::&#x27; + filter.offset);
    // console.log(&#x27;meter:::::::::::::&#x27; + meter);

    const fluxQuery &#x3D; &#x60;from(bucket: &quot;${process.env.INFLUXDB_BUCKET}&quot;) |&gt; range(start:${filter.start} , stop:${filter.end} ) |&gt; filter(fn: (r) &#x3D;&gt; r.meter &#x3D;&#x3D; &quot;${meter}&quot; and r._field &#x3D;&#x3D; &quot;read&quot;) |&gt; limit(n:${filter.limit} , offset:${filter.offset})&#x60;;

    // const result &#x3D; await queryApi.queryRaw(fluxQuery);
    const result &#x3D; await queryApi.collectRows(fluxQuery);
    console.log(result);
    console.log(&#x27;\ncollect-rows query SUCCESS&#x27;);
    return result
  }

}</code></pre>
    </div>

</div>













                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'ReadsService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
